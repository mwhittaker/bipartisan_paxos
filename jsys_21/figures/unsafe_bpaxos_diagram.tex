\begin{wrapfigure}{r}{0pt}
  \centering
  \tikzstyle{proc}=[draw, circle, fill=white, inner sep=1pt]
  \tikzstyle{machine}=[draw, fill=white, draw=gray, fill=flatgray!20,
                       minimum height=1.5cm, minimum width=0.7cm]
  \tikzstyle{arrow}=[thick, -latex]

  \begin{tikzpicture}
    % Dependency service and fast paxos acceptors.
    \begin{scope}[shift={(0, 1.3)}, xscale=1.5, yscale=0.8]
      \node[machine] (m1) at (0, 0.5) {};
      \node[machine] (m2) at (1, 0.5) {};
      \node[machine] (m3) at (2, 0.5) {};
      \node[proc] (d1) at (0, 1) {$d_1$};
      \node[proc] (d2) at (1, 1) {$d_2$};
      \node[proc] (d3) at (2, 1) {$d_3$};
      \node[proc] (a1) at (0, 0) {$a_1$};
      \node[proc] (a2) at (1, 0) {$a_2$};
      \node[proc] (a3) at (2, 0) {$a_3$};
    \end{scope}

    % Simple BPaxos nodes.
    \begin{scope}[shift={(1, 0)}]
      \node[proc] (b1) at (0, 0) {$b_1$};
      \node[proc] (b2) at (1, 0) {$b_2$};
    \end{scope}

    % Arrows.
    \draw[arrow, line width=1.2pt, black!100, bend left=55] (b1) to (d1);
    \draw[arrow, line width=1.2pt, black!100, bend left=15] (b1) to (d2);
    \draw[arrow, line width=1.2pt, black!100] (b1) to (d3);
    \draw[arrow, line width=1pt, black!80] (d1) to (a1);
    \draw[arrow, line width=1pt, black!80] (d2) to (a2);
    \draw[arrow, line width=1pt, black!80] (d3) to (a3);
    \draw[arrow, line width=1pt, black!80] (a1) to (b1);
    \draw[arrow, line width=1pt, black!80] (a2) to (b1);
    \draw[arrow, line width=1pt, black!80] (a3) to (b1);
    \draw[arrow, line width=0.75pt, black!60] (b1) to (b2);
  \end{tikzpicture}
  \caption{Unsafe BPaxos}\figlabel{UnsafeBPaxosDiagram}
\end{wrapfigure}
